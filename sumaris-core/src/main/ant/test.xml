<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
  ~ #%L
  ~ SUMARiS
  ~ %%
  ~ Copyright (C) 2019 SUMARiS Consortium
  ~ %%
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public
  ~ License along with this program.  If not, see
  ~ <http://www.gnu.org/licenses/gpl-3.0.html>.
  ~ #L%
  -->

<project name="Hibernate configuration tools" basedir="." default="hbm2doc">


	<property name="maven.repo" value="${user.home}/.m2/repository/"/>
	<property name="jdbc.driver.jar" value="${maven.repo}/org/hsqldb/hsqldb/2.4.1/hsqldb-2.4.1.jar"/>
	<property name="project.dir" value="${user.home}/git/sumaris/sumaris-pod/sumaris-core"/>
	<property name="outputDirectory" value="${project.dir}/target/classes"/>

	<taskdef resource="net/sf/antcontrib/antlib.xml">
		<classpath>
			<path location="${maven.repo}/ant-contrib/ant-contrib/1.0b3/ant-contrib-1.0b3.jar" />
		</classpath>
	</taskdef>

	<taskdef name="hibernatetool"
			 classname="org.hibernate.tool.ant.HibernateToolTask">
		<classpath>
			<path location="${maven.repo}/org/hibernate/hibernate-tools/5.3.11.Final/hibernate-tools-5.3.11.Final.jar" />
			<path location="${maven.repo}/org/hibernate/hibernate-core/5.3.11.Final/hibernate-core-5.3.11.Final.jar" />
			<path location="${maven.repo}/org/hibernate/common/hibernate-commons-annotations/5.0.4.Final/hibernate-commons-annotations-5.0.4.Final.jar"/>
			<path location="${maven.repo}/org/hibernate/hibernate-annotations/5.3.11.Final/hibernate-annotations-5.3.11.Final.jar" />
			<path location="${maven.repo}/org/hibernate/hibernate-spatial/5.3.11.Final/hibernate-spatial-5.3.11.Final.jar" />
			<path location="${maven.repo}/org/hibernate/hibernate-entitymanager/5.3.11.Final/hibernate-entitymanager-5.3.11.Final.jar" />
			<path location="${maven.repo}/javax/persistence/javax.persistence-api/2.2/javax.persistence-api-2.2.jar" />
			<path location="${maven.repo}/javax/transaction/javax.transaction-api/1.2/javax.transaction-api-1.2.jar" />
			<path location="${maven.repo}/org/jboss/logging/jboss-logging/3.3.2.Final/jboss-logging-3.3.2.Final.jar" />
			<path location="${maven.repo}/org/javassist/javassist/3.25.0-GA/javassist-3.25.0-GA.jar" />
			<path location="${maven.repo}/net/bytebuddy/byte-buddy/1.9.11/byte-buddy-1.9.11.jar" />
			<path location="${maven.repo}/antlr/antlr/2.7.7/antlr-2.7.7.jar"/>
			<path location="${maven.repo}/org/jboss/spec/javax/transaction/jboss-transaction-api_1.2_spec/1.1.1.Final/jboss-transaction-api_1.2_spec-1.1.1.Final.jar"/>
			<path location="${maven.repo}/org/jboss/jandex/2.0.5.Final/jandex-2.0.5.Final.jar"/>
			<path location="${maven.repo}/com/fasterxml/classmate/1.3.4/classmate-1.3.4.jar"/>
			<path location="${maven.repo}/javax/activation/javax.activation-api/1.2.0/javax.activation-api-1.2.0.jar"/>
			<path location="${maven.repo}/org/dom4j/dom4j/2.1.1/dom4j-2.1.1.jar"/>
			<path location="${maven.repo}/org/freemarker/freemarker/2.3.28/freemarker-2.3.28.jar"/>


			<path location="${maven.repo}/commons-logging/commons-logging/1.2/commons-logging-1.2.jar"/>
			<!--		<path location="lib/freemarker.jar" />-->
			<path location="${jdbc.driver.jar}" />
		</classpath>
	</taskdef>

	<target name="hbm2doc">

		<property name="persistence.xml.path" value="${outputDirectory}/META-INF/persistence.xml"/>
		<if>
			<not><available file="${persistence.xml.path}" property="persistence.exists"/></not>
			<then>
				<fail message="persistence.xml file not found at: ${persistence.xml.path}"/>
			</then>
		</if>



		<echo level="warning">STARTING Hbm2doc ant build ${iok}</echo>

		<hibernatetool>
			<classpath>
				<path location="${outputDirectory}" />
				<path location="${maven.repo}/net/sumaris/sumaris-core/0.19.0-SNAPSHOT/sumaris-core-0.19.0-SNAPSHOT.jar"/>
				<path location="${maven.repo}/net/sumaris/sumaris-core-shared/0.19.0-SNAPSHOT/sumaris-core-shared-0.19.0-SNAPSHOT.jar"/>
				<path location="${maven.repo}/org/slf4j/slf4j-api/1.7.26/slf4j-api-1.7.26.jar"/>
				<path location="${maven.repo}/org/springframework/spring-core/5.1.9.RELEASE/spring-core-5.1.9.RELEASE.jar"/>
				<path location="${maven.repo}/org/springframework/spring-beans/5.1.9.RELEASE/spring-beans-5.1.9.RELEASE.jar"/>
				<path location="${maven.repo}/org/nuiton/nuiton-config/3.4/nuiton-config-3.4.jar"/>
				<path location="${maven.repo}/com/vividsolutions/jts-core/1.14.0/jts-core-1.14.0.jar"/>
				<path location="${maven.repo}/com/google/guava/guava/23.0/guava-23.0.jar"/>
				<path location="${maven.repo}/org/slf4j/slf4j-api/2.10.0/slf4j-api-2.10.0.jar"/>
			</classpath>

			<jpaconfiguration persistenceunit="sumaris" />

			<hbm2doc destdir="${project.dir}/site/hibernate" />
		</hibernatetool>
	</target>
</project>